# UIコンポーネント テスト仕様書

## テスト対象
- テーマ切り替え（ダーク/ライトモード）
- レスポンシブデザイン
- アクセシビリティ
- 共通UIコンポーネント

---

## 1. テーマ切り替え機能

### 1.1 ダーク/ライトモード切り替えのテスト

#### テストケース 1.1.1: ライトモードからダークモードへの切り替え
**前提条件:**
- 現在ライトモード

**テスト手順:**
1. ヘッダーのテーマ切り替えボタンをクリック

**期待結果:**
- 画面全体がダークモードに変化
- 背景色が暗色になる
- テキスト色が明色になる
- localStorage に設定が保存される

#### テストケース 1.1.2: ダークモードからライトモードへの切り替え
**テスト手順:**
1. ダークモードでテーマ切り替えボタンをクリック

**期待結果:**
- ライトモードに変化
- 背景色が明色になる
- テキスト色が暗色になる

#### テストケース 1.1.3: システム設定に従う
**テスト手順:**
1. テーマ設定を「システム設定に従う」に変更
2. OSのダークモード設定を変更

**期待結果:**
- OSの設定に応じてテーマが自動切り替わる
- `prefers-color-scheme` メディアクエリが適用される

#### テストケース 1.1.4: テーマ設定の永続化
**テスト手順:**
1. ダークモードに切り替え
2. ページをリロード

**期待結果:**
- リロード後もダークモードが維持される
- localStorage から設定が読み込まれる

---

## 2. レスポンシブデザイン

### 2.1 モバイル表示のテスト

#### テストケース 2.1.1: スマートフォン（375px幅）での表示
**テスト手順:**
1. 画面幅を375pxに設定
2. 各ページを確認

**期待結果:**
- すべての要素が画面幅に収まる
- ハンバーガーメニューが表示される
- タッチ操作に適したボタンサイズ（最小44x44px）

#### テストケース 2.1.2: タブレット（768px幅）での表示
**テスト手順:**
1. 画面幅を768pxに設定

**期待結果:**
- 適切な2カラムレイアウト
- ナビゲーションメニューが適切に表示される

#### テストケース 2.1.3: デスクトップ（1920px幅）での表示
**テスト手順:**
1. 画面幅を1920pxに設定

**期待結果:**
- 最大幅が適切に制限される（例: 1200px）
- サイドバーが表示される

---

### 2.2 ブレークポイント切り替えのテスト

#### テストケース 2.2.1: 画面幅変更時のレイアウト変化
**テスト手順:**
1. デスクトップ表示からスマートフォン表示にリサイズ

**期待結果:**
- レイアウトがスムーズに切り替わる
- コンテンツの欠落がない

---

## 3. アクセシビリティ

### 3.1 キーボードナビゲーションのテスト

#### テストケース 3.1.1: タブキーでのフォーカス移動
**テスト手順:**
1. ページ上でTabキーを連続で押す

**期待結果:**
- すべてのインタラクティブ要素にフォーカスが移動
- フォーカス順序が論理的
- フォーカスインジケーターが明確に表示される

#### テストケース 3.1.2: Enterキーでのボタン操作
**テスト手順:**
1. ボタンにフォーカスを当ててEnterキーを押す

**期待結果:**
- ボタンのクリック動作が実行される

#### テストケース 3.1.3: Escキーでのモーダルクローズ
**テスト手順:**
1. モーダルを開く
2. Escキーを押す

**期待結果:**
- モーダルが閉じる

---

### 3.2 スクリーンリーダー対応のテスト

#### テストケース 3.2.1: 画像の代替テキスト
**テスト手順:**
1. スクリーンリーダーで画像要素を確認

**期待結果:**
- すべての画像に適切な `alt` 属性がある
- 装飾画像は `alt=""` または `role="presentation"`

#### テストケース 3.2.2: ARIAラベルの設定
**テスト手順:**
1. アイコンボタンをスクリーンリーダーで確認

**期待結果:**
- `aria-label` が適切に設定されている
- ボタンの目的が音声で理解できる

#### テストケース 3.2.3: フォーム要素のラベル
**テスト手順:**
1. フォーム入力欄をスクリーンリーダーで確認

**期待結果:**
- すべての入力欄に `<label>` が関連付けられている
- プレースホルダーのみに頼っていない

---

### 3.3 色覚多様性への対応テスト

#### テストケース 3.3.1: 色のみに頼らない情報伝達
**テスト手順:**
1. エラーメッセージやボタンの状態を確認

**期待結果:**
- 赤色だけでなくアイコンやテキストでも状態がわかる
- 成功/エラーがアイコン+色で表現される

#### テストケース 3.3.2: コントラスト比の確認
**テスト手順:**
1. Lighthouse や axe DevTools でコントラスト比を測定

**期待結果:**
- 通常テキスト: 4.5:1 以上
- 大きいテキスト: 3:1 以上

---

## 4. 共通UIコンポーネント

### 4.1 ボタンコンポーネントのテスト

#### テストケース 4.1.1: プライマリボタン
**テスト手順:**
1. プライマリボタンを表示

**期待結果:**
- 適切な色とサイズ
- ホバー時に視覚的フィードバック
- 無効状態が正しく表示される

#### テストケース 4.1.2: ローディング状態
**テスト手順:**
1. ボタンをクリックして非同期処理を開始

**期待結果:**
- ボタンが無効化される
- スピナーが表示される
- 二重送信が防止される

---

### 4.2 入力フォームコンポーネントのテスト

#### テストケース 4.2.1: テキスト入力
**テスト手順:**
1. テキストフィールドに文字を入力

**期待結果:**
- 入力値が正しく反映される
- バリデーションエラーが適切に表示される

#### テストケース 4.2.2: パスワード表示切り替え
**テスト手順:**
1. パスワードフィールドの表示切り替えボタンをクリック

**期待結果:**
- パスワードが平文で表示される
- ボタンアイコンが変化

---

### 4.3 モーダルコンポーネントのテスト

#### テストケース 4.3.1: モーダルの開閉
**テスト手順:**
1. モーダルを開くボタンをクリック
2. 背景をクリック
3. 閉じるボタンをクリック

**期待結果:**
- 手順1: モーダルが開く
- 手順2: モーダルが閉じる
- 手順3: モーダルが閉じる

#### テストケース 4.3.2: フォーカストラップ
**テスト手順:**
1. モーダルを開く
2. Tabキーを連続で押す

**期待結果:**
- フォーカスがモーダル内の要素のみを循環
- モーダル外の要素にフォーカスが移動しない

---

### 4.4 トースト通知コンポーネントのテスト

#### テストケース 4.4.1: 成功通知の表示
**テスト手順:**
1. 成功アクションを実行

**期待結果:**
- 画面上部に緑色のトースト通知が表示される
- 3秒後に自動で消える
- 閉じるボタンで手動で閉じられる

#### テストケース 4.4.2: エラー通知の表示
**テスト手順:**
1. エラーアクションを実行

**期待結果:**
- 赤色のトースト通知が表示される
- 自動で消えない（手動クローズのみ）

---

## 5. アニメーション・トランジション

### 5.1 ページ遷移アニメーションのテスト

#### テストケース 5.1.1: フェードイン効果
**テスト手順:**
1. ページ間を遷移

**期待結果:**
- スムーズなフェードイン効果
- アニメーション時間が適切（200-300ms）

#### テストケース 5.1.2: アニメーション無効設定の尊重
**テスト手順:**
1. OS設定で「視差効果を減らす」を有効化

**期待結果:**
- アニメーションが無効化される
- `prefers-reduced-motion` メディアクエリが適用される

---

## パフォーマンステスト

### テストケース P.1: レンダリング速度
**テスト手順:**
1. Lighthouse でパフォーマンススコアを測定

**期待結果:**
- パフォーマンススコア 90 以上
- FCP（First Contentful Paint）2秒以内
- LCP（Largest Contentful Paint）2.5秒以内

---

## テスト環境

### 必要な環境
- ブラウザ: Chrome, Firefox, Safari, Edge
- デバイス: デスクトップ、タブレット、スマートフォン
- スクリーンリーダー: NVDA（Windows）、VoiceOver（Mac/iOS）
- ツール: Lighthouse, axe DevTools

---

## 自動テストの実装

### Jestテストケース例

```typescript
// components/__tests__/Button.test.tsx

import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from '../ui/Button';

describe('Button', () => {
  it('should render with text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });

  it('should handle click event', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click</Button>);
    fireEvent.click(screen.getByText('Click'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('should be disabled', () => {
    render(<Button disabled>Disabled</Button>);
    expect(screen.getByText('Disabled')).toBeDisabled();
  });

  it('should show loading state', () => {
    render(<Button loading>Loading</Button>);
    expect(screen.getByRole('button')).toBeDisabled();
  });
});
```

---

## テスト完了チェックリスト

- [ ] テーマ切り替えテストが通過
- [ ] レスポンシブデザインテストが通過
- [ ] キーボードナビゲーションテストが通過
- [ ] スクリーンリーダーテストが通過
- [ ] 色覚対応テストが通過
- [ ] 共通UIコンポーネントテストが通過
- [ ] アニメーションテストが通過
- [ ] Lighthouseスコア 90以上達成
- [ ] axe DevTools でエラー0件
